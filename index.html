<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¹¸è¿å¤§æŠ½å¥– - å›¾ç‰‡ç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            padding: 20px;
            color: white;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
        }
        
        .header {
            margin-bottom: 40px;
            padding: 20px;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        /* å¥–å“å±•ç¤ºåŒºåŸŸ */
        .prize-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .prize-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 2px solid transparent;
            cursor: pointer;
        }
        
        .prize-item.selected {
            border-color: #FFD700;
            box-shadow: 0 0 25px #FFD700;
            transform: scale(1.05);
        }
        
        .prize-image {
            width: 100%;
            height: 180px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 15px;
            transition: transform 0.5s ease;
        }
        
        .prize-item:hover .prize-image {
            transform: rotateY(20deg);
        }
        
        .prize-name {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .prize-probability {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        /* æ§åˆ¶é¢æ¿ */
        .control-panel {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .result-display {
            font-size: 1.8rem;
            min-height: 60px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .result-image {
            max-width: 150px;
            max-height: 150px;
            border-radius: 10px;
            display: none;
            margin: 0 auto;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 15px 35px;
            font-size: 1.1rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            min-width: 160px;
        }
        
        .start-btn {
            background: linear-gradient(to right, #FF416C, #FF4B2B);
            color: white;
        }
        
        .start-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(255, 75, 43, 0.4);
        }
        
        .reset-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
        }
        
        .reset-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        /* ä¸­å¥–å†å² */
        .history {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
        }
        
        .history-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
        }
        
        .history-list {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }
        
        .history-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            font-size: 0.9rem;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .prize-container {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
                gap: 15px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 280px;
            }
        }
        
        /* æŠ½å¥–åŠ¨ç”» */
        @keyframes lotterySpin {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .lottery-spin {
            animation: lotterySpin 0.5s ease infinite;
        }
        
        /* é—ªå…‰æ•ˆæœ */
        @keyframes sparkle {
            0% { box-shadow: 0 0 5px #FFD700; }
            50% { box-shadow: 0 0 25px #FFD700; }
            100% { box-shadow: 0 0 5px #FFD700; }
        }
        
        .sparkle {
            animation: sparkle 1s ease infinite;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ å¹¸è¿å¤§æŠ½å¥– ğŸ</h1>
            <p class="subtitle">ç‚¹å‡»å¼€å§‹æŒ‰é’®ï¼ŒæŠ½å–ä½ çš„ä¸“å±å¹¸è¿å¥–å“ï¼</p>
        </div>
        
        <!-- å¥–å“å±•ç¤ºåŒº -->
        <div class="prize-container" id="prizeContainer">
            <!-- å¥–å“å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </div>
        
        <!-- æ§åˆ¶é¢æ¿ -->
        <div class="control-panel">
            <div class="result-display" id="resultDisplay">
                ç­‰å¾…æŠ½å¥–å¼€å§‹...
            </div>
            <img id="resultImage" class="result-image" alt="ä¸­å¥–å¥–å“">
            
            <div class="controls">
                <button class="btn start-btn" id="startBtn">ğŸ° å¼€å§‹æŠ½å¥–</button>
                <button class="btn reset-btn" id="resetBtn">ğŸ”„ é‡ç½®è®°å½•</button>
            </div>
            
            <div class="stats">
                <p>å‰©ä½™æŠ½å¥–æ¬¡æ•°: <span id="remainingChances">3</span> æ¬¡</p>
                <p>ä»Šæ—¥å·²æŠ½: <span id="todayCount">0</span> æ¬¡</p>
            </div>
        </div>
        
        <!-- ä¸­å¥–å†å² -->
        <div class="history">
            <h3 class="history-title">ğŸ“œ ä¸­å¥–å†å²è®°å½•</h3>
            <div class="history-list" id="historyList">
                <!-- å†å²è®°å½•å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <script>
        // å¥–å“æ•°æ® - ä½ å¯ä»¥ä¿®æ”¹è¿™é‡Œçš„å›¾ç‰‡å’Œå¥–å“ä¿¡æ¯
        const prizes = [
            {
                id: 1,
                name: "ç‰¹ç­‰å¥–ï¼šiPhone 16",
                image: "https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=400&h=400&fit=crop",
                probability: 5 // ä¸­å¥–æ¦‚ç‡5%
            },
            {
                id: 2,
                name: "ä¸€ç­‰å¥–ï¼šiPad Pro",
                image: "https://images.unsplash.com/photo-1544244015-0df4b3ffc6b0?w-400&h=400&fit=crop",
                probability: 10
            },
            {
                id: 3,
                name: "äºŒç­‰å¥–ï¼šAirPods",
                image: "https://images.unsplash.com/photo-1572569511254-d8f925fe2cbb?w=400&h=400&fit=crop",
                probability: 15
            },
            {
                id: 4,
                name: "ä¸‰ç­‰å¥–ï¼šæ™ºèƒ½æ‰‹è¡¨",
                image: "https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=400&h=400&fit=crop",
                probability: 20
            },
            {
                id: 5,
                name: "å››ç­‰å¥–ï¼šè“ç‰™éŸ³ç®±",
                image: "https://images.unsplash.com/photo-1546435770-a3e426bf472b?w=400&h=400&fit=crop",
                probability: 25
            },
            {
                id: 6,
                name: "å‚ä¸å¥–ï¼šä¼˜æƒ åˆ¸",
                image: "https://images.unsplash.com/photo-1607082348824-0a96f2a4b9da?w=400&h=400&fit=crop",
                probability: 25
            }
        ];

        // çŠ¶æ€å˜é‡
        let isDrawing = false;
        let remainingChances = 3;
        let todayCount = 0;
        let lotteryHistory = [];
        let currentSpinInterval = null;

        // DOMå…ƒç´ 
        const prizeContainer = document.getElementById('prizeContainer');
        const resultDisplay = document.getElementById('resultDisplay');
        const resultImage = document.getElementById('resultImage');
        const startBtn = document.getElementById('startBtn');
        const resetBtn = document.getElementById('resetBtn');
        const remainingChancesEl = document.getElementById('remainingChances');
        const todayCountEl = document.getElementById('todayCount');
        const historyList = document.getElementById('historyList');

        // åˆå§‹åŒ–å¥–å“å±•ç¤º
        function initializePrizes() {
            prizeContainer.innerHTML = '';
            prizes.forEach(prize => {
                const prizeItem = document.createElement('div');
                prizeItem.className = 'prize-item';
                prizeItem.dataset.id = prize.id;
                
                prizeItem.innerHTML = `
                    <img src="${prize.image}" alt="${prize.name}" class="prize-image">
                    <div class="prize-name">${prize.name}</div>
                    <div class="prize-probability">ä¸­å¥–ç‡: ${prize.probability}%</div>
                `;
                
                prizeContainer.appendChild(prizeItem);
            });
        }

        // æŠ½å¥–å‡½æ•°
        function startLottery() {
            if (isDrawing) return;
            if (remainingChances <= 0) {
                resultDisplay.textContent = "æŠ½å¥–æ¬¡æ•°å·²ç”¨å®Œï¼";
                return;
            }
            
            isDrawing = true;
            startBtn.disabled = true;
            startBtn.textContent = "æŠ½å¥–ä¸­...";
            startBtn.classList.add('lottery-spin');
            
            // é‡ç½®æ‰€æœ‰å¥–å“é«˜äº®
            document.querySelectorAll('.prize-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            // æ¨¡æ‹ŸæŠ½å¥–è¿‡ç¨‹
            let spinCount = 0;
            const maxSpins = 20;
            const spinInterval = 100;
            
            currentSpinInterval = setInterval(() => {
                spinCount++;
                
                // éšæœºé«˜äº®ä¸€ä¸ªå¥–å“
                const randomIndex = Math.floor(Math.random() * prizes.length);
                document.querySelectorAll('.prize-item').forEach(item => {
                    item.classList.remove('selected');
                });
                
                const currentPrizeItem = document.querySelector(`[data-id="${prizes[randomIndex].id}"]`);
                if (currentPrizeItem) {
                    currentPrizeItem.classList.add('selected');
                }
                
                // æœ€åä¸€æ¬¡æ—‹è½¬ï¼Œç¡®å®šæœ€ç»ˆç»“æœ
                if (spinCount >= maxSpins) {
                    clearInterval(currentSpinInterval);
                    determineResult();
                }
            }, spinInterval);
        }

        // ç¡®å®šæŠ½å¥–ç»“æœ
        function determineResult() {
            // åŸºäºæ¦‚ç‡è®¡ç®—ä¸­å¥–ç»“æœ
            const totalProbability = prizes.reduce((sum, prize) => sum + prize.probability, 0);
            let randomNum = Math.random() * totalProbability;
            
            let selectedPrize = prizes[0];
            for (const prize of prizes) {
                if (randomNum < prize.probability) {
                    selectedPrize = prize;
                    break;
                }
                randomNum -= prize.probability;
            }
            
            // æ˜¾ç¤ºç»“æœ
            setTimeout(() => {
                resultDisplay.textContent = `æ­å–œä½ æŠ½ä¸­ï¼š${selectedPrize.name}`;
                resultImage.src = selectedPrize.image;
                resultImage.style.display = 'block';
                
                // é«˜äº®æ˜¾ç¤ºä¸­å¥–å¥–å“
                document.querySelectorAll('.prize-item').forEach(item => {
                    item.classList.remove('selected');
                });
                const winningItem = document.querySelector(`[data-id="${selectedPrize.id}"]`);
                if (winningItem) {
                    winningItem.classList.add('selected', 'sparkle');
                }
                
                // æ›´æ–°çŠ¶æ€
                remainingChances--;
                todayCount++;
                remainingChancesEl.textContent = remainingChances;
                todayCountEl.textContent = todayCount;
                
                // æ·»åŠ åˆ°å†å²è®°å½•
                addToHistory(selectedPrize);
                
                // é‡ç½®æŒ‰é’®çŠ¶æ€
                isDrawing = false;
                startBtn.disabled = false;
                startBtn.textContent = "ğŸ° å¼€å§‹æŠ½å¥–";
                startBtn.classList.remove('lottery-spin');
                
                // æ’­æ”¾éŸ³æ•ˆï¼ˆå¯é€‰ï¼‰
                playWinSound();
                
            }, 500);
        }

        // æ·»åŠ åˆ°å†å²è®°å½•
        function addToHistory(prize) {
            const now = new Date();
            const timeString = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
            
            lotteryHistory.unshift({
                prize: prize.name,
                time: timeString
            });
            
            // åªä¿ç•™æœ€è¿‘10æ¡è®°å½•
            if (lotteryHistory.length > 10) {
                lotteryHistory = lotteryHistory.slice(0, 10);
            }
            
            updateHistoryDisplay();
        }

        // æ›´æ–°å†å²è®°å½•æ˜¾ç¤º
        function updateHistoryDisplay() {
            historyList.innerHTML = '';
            lotteryHistory.forEach(record => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.textContent = `${record.time} - ${record.prize}`;
                historyList.appendChild(historyItem);
            });
        }

        // é‡ç½®è®°å½•
        function resetRecords() {
            if (isDrawing) {
                clearInterval(currentSpinInterval);
                isDrawing = false;
                startBtn.disabled = false;
                startBtn.textContent = "ğŸ° å¼€å§‹æŠ½å¥–";
                startBtn.classList.remove('lottery-spin');
            }
            
            remainingChances = 3;
            todayCount = 0;
            lotteryHistory = [];
            
            remainingChancesEl.textContent = remainingChances;
            todayCountEl.textContent = todayCount;
            resultDisplay.textContent = "ç­‰å¾…æŠ½å¥–å¼€å§‹...";
            resultImage.style.display = 'none';
            
            document.querySelectorAll('.prize-item').forEach(item => {
                item.classList.remove('selected', 'sparkle');
            });
            
            updateHistoryDisplay();
        }

        // æ’­æ”¾éŸ³æ•ˆï¼ˆç®€å•ç‰ˆæœ¬ï¼‰
        function playWinSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 800;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                console.log("éŸ³æ•ˆæ’­æ”¾å¤±è´¥ï¼Œä¸å½±å“ä¸»è¦åŠŸèƒ½");
            }
        }

        // äº‹ä»¶ç›‘å¬
        startBtn.addEventListener('click', startLottery);
        resetBtn.addEventListener('click', resetRecords);

        // åˆå§‹åŒ–
        initializePrizes();
        updateHistoryDisplay();
        
        // æç¤ºç”¨æˆ·å¦‚ä½•è‡ªå®šä¹‰
        console.log("ğŸ’¡ è‡ªå®šä¹‰æç¤ºï¼š");
        console.log("1. ä¿®æ”¹prizesæ•°ç»„ä¸­çš„å¥–å“å›¾ç‰‡é“¾æ¥å’Œåç§°");
        console.log("2. è°ƒæ•´probabilityå€¼æ”¹å˜ä¸­å¥–æ¦‚ç‡");
        console.log("3. å°†ä»£ç ä¿å­˜ä¸ºindex.htmlä¸Šä¼ åˆ°GitHubå³å¯åˆ†äº«");
    </script>
</body>
</html>

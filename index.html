<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¹¸è¿å¤§æŠ½å¥– - ç¯ç»•å¼</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            min-height: 100vh;
            color: white;
            padding: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            width: 100%;
            max-width: 1000px;
            text-align: center;
        }
        
        /* å¤´éƒ¨ */
        .header {
            margin-bottom: 20px;
            padding: 20px;
        }
        
        h1 {
            font-size: clamp(24px, 5vw, 36px);
            margin-bottom: 10px;
            background: linear-gradient(to right, #FFD700, #FFA500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .subtitle {
            font-size: clamp(14px, 3vw, 18px);
            opacity: 0.8;
            margin-bottom: 20px;
        }
        
        /* éŸ³ä¹æ§åˆ¶ */
        .music-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .control-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 215, 0, 0.5);
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: clamp(14px, 3vw, 16px);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        /* ä¸»æŠ½å¥–åŒºåŸŸ */
        .lottery-area {
            position: relative;
            width: 100%;
            max-width: 600px;
            aspect-ratio: 1 / 1;
            margin: 0 auto 30px;
        }
        
        /* å¥–å“ç¯ç»•åœˆ - å“åº”å¼å®šä½ */
        .prize-circle {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: grid;
            place-items: center;
        }
        
        .prize-item {
            position: absolute;
            width: clamp(80px, 15vw, 120px);
            height: clamp(80px, 15vw, 120px);
            transition: all 0.3s ease;
            transform-origin: 50% 50%;
        }
        
        .prize-item-inner {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .prize-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s;
        }
        
        .prize-item.active img {
            border-color: #FFD700;
            box-shadow: 0 0 20px #FFD700;
        }
        
        .prize-name {
            margin-top: 8px;
            font-size: clamp(12px, 2.5vw, 14px);
            background: rgba(0, 0, 0, 0.7);
            padding: 3px 8px;
            border-radius: 10px;
            white-space: nowrap;
        }
        
        /* ä¸­å¿ƒæŠ½å¥–æŒ‰é’® */
        .center-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 100;
        }
        
        .lottery-btn {
            width: clamp(120px, 25vw, 160px);
            height: clamp(120px, 25vw, 160px);
            border-radius: 50%;
            background: linear-gradient(145deg, #FF416C, #FF4B2B);
            border: none;
            color: white;
            font-size: clamp(16px, 3vw, 20px);
            font-weight: bold;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        /* ç»“æœå±•ç¤º */
        .result-display {
            margin: 20px auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            max-width: 600px;
        }
        
        .result-text {
            font-size: clamp(18px, 4vw, 24px);
            margin-bottom: 15px;
            min-height: 40px;
        }
        
        .result-prize {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }
        
        @media (min-width: 768px) {
            .result-prize {
                flex-direction: row;
                justify-content: center;
            }
        }
        
        .result-image {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 12px;
            border: 2px solid #FFD700;
        }
        
        /* ä¸­å¥–åå• */
        .winner-board {
            margin-top: 30px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .board-header {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 215, 0, 0.3);
        }
        
        @media (min-width: 576px) {
            .board-header {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
        }
        
        .board-title {
            font-size: clamp(18px, 4vw, 20px);
            color: #FFD700;
        }
        
        .view-history-btn {
            background: rgba(255, 215, 0, 0.2);
            border: 1px solid #FFD700;
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: clamp(14px, 3vw, 16px);
        }
        
        .winner-scroll {
            height: 200px;
            overflow: hidden;
            position: relative;
        }
        
        .winner-list {
            list-style: none;
            animation: scrollList 30s linear infinite;
        }
        
        @keyframes scrollList {
            0% { transform: translateY(0); }
            100% { transform: translateY(-50%); }
        }
        
        .winner-list li {
            padding: 10px;
            margin: 5px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* å†å²è®°å½•å¼¹çª— */
        .history-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .history-content {
            background: #1a1a2e;
            width: 100%;
            max-width: 800px;
            max-height: 80vh;
            border-radius: 15px;
            padding: 20px;
            position: relative;
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            width: 30px;
            height: 30px;
        }
        
        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes rotateIndicator {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        .spinning {
            animation: rotateIndicator 1s linear infinite;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <div class="header">
            <h1>ğŸ° å¹¸è¿å¤§æŠ½å¥– ğŸ°</h1>
            <p class="subtitle">ç‚¹å‡»ä¸­å¤®æŒ‰é’®å¼€å§‹æŠ½å¥–ï¼Œå¥–å“ç¯ç»•æ—‹è½¬ï¼Œç¥ä½ å¥½è¿ï¼</p>
            
            <!-- éŸ³ä¹æ§åˆ¶ -->
            <div class="music-controls">
                <button class="control-btn" id="bgMusicBtn">
                    <span>ğŸµ</span> èƒŒæ™¯éŸ³ä¹: <span id="bgMusicStatus">å¼€å¯</span>
                </button>
                <button class="control-btn" id="soundEffectBtn">
                    <span>ğŸ”Š</span> æ—‹è½¬éŸ³æ•ˆ: <span id="soundEffectStatus">å¼€å¯</span>
                </button>
            </div>
        </div>
        
        <!-- ä¸»æŠ½å¥–åŒºåŸŸ -->
        <div class="lottery-area">
            <!-- å¥–å“ç¯ç»•åœˆ -->
            <div class="prize-circle" id="prizeCircle">
                <!-- å¥–å“é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
            </div>
            
            <!-- ä¸­å¿ƒæŠ½å¥–æŒ‰é’® -->
            <div class="center-button">
                <button class="lottery-btn" id="startLotteryBtn">
                    <div style="font-size: 32px;">ğŸ</div>
                    <div>å¼€å§‹æŠ½å¥–</div>
                    <div style="font-size: 14px;">å‰©ä½™: <span id="chanceCount">3</span> æ¬¡</div>
                </button>
            </div>
        </div>
        
        <!-- ç»“æœå±•ç¤º -->
        <div class="result-display">
            <div class="result-text" id="resultText">
                ç­‰å¾…æŠ½å¥–å¼€å§‹...
            </div>
            <div class="result-prize" id="resultPrize" style="display: none;">
                <img id="resultImage" class="result-image" alt="ä¸­å¥–å¥–å“">
                <div>
                    <div style="color: #FFD700; font-size: 18px;" id="resultPrizeName"></div>
                    <div style="margin-top: 8px; font-size: 14px;" id="resultTime"></div>
                </div>
            </div>
        </div>
        
        <!-- ä¸­å¥–åå•æ»šåŠ¨æ¿ -->
        <div class="winner-board">
            <div class="board-header">
                <div class="board-title">ğŸ† å®æ—¶ä¸­å¥–åå•</div>
                <button class="view-history-btn" id="viewHistoryBtn">
                    ğŸ“œ æŸ¥çœ‹å†å²è®°å½•
                </button>
            </div>
            
            <div class="winner-scroll">
                <ul class="winner-list" id="winnerList">
                    <!-- ä¸­å¥–åå•é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                </ul>
            </div>
        </div>
    </div>
    
    <!-- å†å²è®°å½•å¼¹çª— -->
    <div class="history-modal" id="historyModal">
        <div class="history-content">
            <button class="close-modal" id="closeModal">Ã—</button>
            <h2 style="color: #FFD700; margin-bottom: 15px;">ğŸ“‹ å®Œæ•´ä¸­å¥–å†å²</h2>
            <div id="historyContent" style="max-height: 60vh; overflow-y: auto;">
                <!-- å†å²è®°å½•å†…å®¹é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>
    
    <!-- éŸ³ä¹å…ƒç´  -->
    <audio id="backgroundMusic" loop>
        <source src="papa.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="dingSound" preload="auto">
        <!-- å®å®å®éŸ³æ•ˆ -->
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-bell-notification-933.mp3" type="audio/mpeg">
    </audio>

    <script>
        // å¥–å“æ•°æ®
        const prizes = [
            { id: 1, name: "iPhone 16", image: "https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=300&h=300&fit=crop", probability: 5 },
            { id: 2, name: "iPad Air", image: "https://images.unsplash.com/photo-1544244015-0df4b3ffc6b0?w=300&h=300&fit=crop", probability: 8 },
            { id: 3, name: "AirPods", image: "https://images.unsplash.com/photo-1572569511254-d8f925fe2cbb?w=300&h=300&fit=crop", probability: 12 },
            { id: 4, name: "Switch", image: "https://images.unsplash.com/photo-1550745165-9bc0b252726f?w=300&h=300&fit=crop", probability: 15 },
            { id: 5, name: "æ™ºèƒ½æ‰‹è¡¨", image: "https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=300&h=300&fit=crop", probability: 20 },
            { id: 6, name: "ç›¸æœº", image: "https://images.unsplash.com/photo-1516035069371-29a1b244cc32?w=300&h=300&fit=crop", probability: 40 }
        ];

        // çŠ¶æ€å˜é‡
        let isDrawing = false;
        let remainingChances = 3;
        let isBgMusicOn = true;
        let isSoundEffectOn = true;
        let winners = [];
        let history = [];
        let spinInterval = null;
        
        // é¢„å®šä¹‰ä¸€äº›éšæœºåå­—
        const sampleNames = ["å¼ ä¸‰", "æå››", "ç‹äº”", "èµµå…­", "é’±ä¸ƒ", "å­™å…«", "å‘¨ä¹", "å´å"];

        // DOMå…ƒç´ 
        const prizeCircle = document.getElementById('prizeCircle');
        const startLotteryBtn = document.getElementById('startLotteryBtn');
        const chanceCount = document.getElementById('chanceCount');
        const resultText = document.getElementById('resultText');
        const resultPrize = document.getElementById('resultPrize');
        const resultImage = document.getElementById('resultImage');
        const resultPrizeName = document.getElementById('resultPrizeName');
        const resultTime = document.getElementById('resultTime');
        const winnerList = document.getElementById('winnerList');
        const bgMusicBtn = document.getElementById('bgMusicBtn');
        const soundEffectBtn = document.getElementById('soundEffectBtn');
        const bgMusicStatus = document.getElementById('bgMusicStatus');
        const soundEffectStatus = document.getElementById('soundEffectStatus');
        const viewHistoryBtn = document.getElementById('viewHistoryBtn');
        const historyModal = document.getElementById('historyModal');
        const closeModal = document.getElementById('closeModal');
        const historyContent = document.getElementById('historyContent');
        
        // éŸ³é¢‘å…ƒç´ 
        const bgMusic = document.getElementById('backgroundMusic');
        const dingSound = document.getElementById('dingSound');

        // åˆå§‹åŒ–å¥–å“ç¯ç»•å¸ƒå±€
        function initializePrizes() {
            prizeCircle.innerHTML = '';
            const prizeCount = prizes.length;
            const radius = 40; // ç™¾åˆ†æ¯”åŠå¾„
            
            prizes.forEach((prize, index) => {
                const angle = (360 / prizeCount) * index;
                const radians = (angle * Math.PI) / 180;
                
                const prizeItem = document.createElement('div');
                prizeItem.className = 'prize-item';
                prizeItem.dataset.id = prize.id;
                prizeItem.dataset.index = index;
                
                // ä½¿ç”¨transformå®šä½
                const x = 50 + radius * Math.cos(radians);
                const y = 50 + radius * Math.sin(radians);
                
                prizeItem.style.left = `${x}%`;
                prizeItem.style.top = `${y}%`;
                prizeItem.style.transform = `translate(-50%, -50%)`;
                
                prizeItem.innerHTML = `
                    <div class="prize-item-inner">
                        <img src="${prize.image}" alt="${prize.name}">
                        <div class="prize-name">${prize.name}</div>
                    </div>
                `;
                
                prizeCircle.appendChild(prizeItem);
            });
        }

        // æ’­æ”¾å®å®å®éŸ³æ•ˆ
        function playDingSound() {
            if (!isSoundEffectOn) return;
            
            try {
                dingSound.currentTime = 0;
                dingSound.play().catch(e => console.log("éŸ³æ•ˆæ’­æ”¾å¤±è´¥"));
            } catch (e) {
                console.log("éŸ³æ•ˆé”™è¯¯:", e);
            }
        }

        // å¼€å§‹æŠ½å¥–
        function startLottery() {
            if (isDrawing) return;
            if (remainingChances <= 0) {
                resultText.textContent = "æŠ½å¥–æ¬¡æ•°å·²ç”¨å®Œï¼";
                return;
            }
            
            isDrawing = true;
            startLotteryBtn.disabled = true;
            startLotteryBtn.innerHTML = `
                <div style="font-size: 32px;" class="spinning">ğŸ¯</div>
                <div>æŠ½å¥–ä¸­...</div>
            `;
            
            // ç¡®å®šä¸­å¥–å¥–å“ï¼ˆåŸºäºæ¦‚ç‡ï¼‰
            const totalProbability = prizes.reduce((sum, prize) => sum + prize.probability, 0);
            let randomNum = Math.random() * totalProbability;
            let selectedPrize = prizes[0];
            let targetIndex = 0;
            
            for (let i = 0; i < prizes.length; i++) {
                if (randomNum < prizes[i].probability) {
                    selectedPrize = prizes[i];
                    targetIndex = i;
                    break;
                }
                randomNum -= prizes[i].probability;
            }
            
            // æ¸…é™¤æ‰€æœ‰é«˜äº®
            document.querySelectorAll('.prize-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // æ—‹è½¬é€»è¾‘ï¼šå…ˆå¿«åæ…¢ï¼Œæœ€ç»ˆåœåœ¨ç›®æ ‡ä½ç½®
            let currentIndex = 0;
            let spinCount = 0;
            const totalSpins = 20; // æ€»æ—‹è½¬æ¬¡æ•°
            const baseSpeed = 80; // åˆå§‹é€Ÿåº¦(ms)
            
            function spin() {
                // æ’­æ”¾éŸ³æ•ˆ
                playDingSound();
                
                // æ¸…é™¤ä¸Šä¸€ä¸ªé«˜äº®
                const prevIndex = (currentIndex - 1 + prizes.length) % prizes.length;
                const prevPrize = document.querySelector(`[data-index="${prevIndex}"]`);
                if (prevPrize) prevPrize.classList.remove('active');
                
                // é«˜äº®å½“å‰
                const currentPrize = document.querySelector(`[data-index="${currentIndex}"]`);
                if (currentPrize) {
                    currentPrize.classList.add('active');
                }
                
                currentIndex = (currentIndex + 1) % prizes.length;
                spinCount++;
                
                // åŠ¨æ€é€Ÿåº¦ï¼šå…ˆå¿«åæ…¢
                let currentSpeed;
                if (spinCount < totalSpins * 0.7) {
                    // å‰70%å¿«é€Ÿæ—‹è½¬
                    currentSpeed = baseSpeed;
                } else {
                    // å30%é€æ¸å‡é€Ÿ
                    const progress = (spinCount - totalSpins * 0.7) / (totalSpins * 0.3);
                    currentSpeed = baseSpeed + progress * 200;
                }
                
                if (spinCount < totalSpins) {
                    spinInterval = setTimeout(spin, currentSpeed);
                } else {
                    // æœ€åä¸€æ¬¡è°ƒæ•´åˆ°ç›®æ ‡ä½ç½®
                    clearTimeout(spinInterval);
                    setTimeout(() => {
                        finalizeResult(selectedPrize, targetIndex);
                    }, 300);
                }
            }
            
            spin();
        }

        // æœ€ç»ˆç¡®å®šç»“æœ
        function finalizeResult(selectedPrize, targetIndex) {
            // æ¸…é™¤æ‰€æœ‰é«˜äº®
            document.querySelectorAll('.prize-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // é«˜äº®æœ€ç»ˆå¥–å“
            const winningItem = document.querySelector(`[data-index="${targetIndex}"]`);
            if (winningItem) {
                winningItem.classList.add('active');
            }
            
            // æ˜¾ç¤ºç»“æœ
            const now = new Date();
            const fullTime = `${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2,'0')}-${now.getDate().toString().padStart(2,'0')} ${now.getHours().toString().padStart(2,'0')}:${now.getMinutes().toString().padStart(2,'0')}:${now.getSeconds().toString().padStart(2,'0')}`;
            const shortTime = `${now.getHours().toString().padStart(2,'0')}:${now.getMinutes().toString().padStart(2,'0')}`;
            
            resultText.textContent = `ğŸ‰ æ­å–œï¼æŠ½ä¸­ ${selectedPrize.name} ğŸ‰`;
            resultImage.src = selectedPrize.image;
            resultPrizeName.textContent = selectedPrize.name;
            resultTime.textContent = `ä¸­å¥–æ—¶é—´: ${fullTime}`;
            resultPrize.style.display = 'flex';
            
            // æ›´æ–°çŠ¶æ€
            remainingChances--;
            chanceCount.textContent = remainingChances;
            
            // ç”Ÿæˆéšæœºä¸­å¥–è€…
            const randomName = sampleNames[Math.floor(Math.random() * sampleNames.length)];
            
            // æ·»åŠ åˆ°ä¸­å¥–åå•ï¼ˆçŸ­æ—¶é—´æ ¼å¼ï¼‰
            addToWinners(randomName, selectedPrize.name, shortTime);
            
            // æ·»åŠ åˆ°å†å²è®°å½•ï¼ˆå®Œæ•´æ—¶é—´æ ¼å¼ï¼‰
            history.unshift({
                name: randomName,
                prize: selectedPrize.name,
                time: fullTime,
                image: selectedPrize.image
            });
            
            // é‡ç½®æŒ‰é’®çŠ¶æ€
            isDrawing = false;
            startLotteryBtn.disabled = false;
            startLotteryBtn.innerHTML = `
                <div style="font-size: 32px;">ğŸ</div>
                <div>å¼€å§‹æŠ½å¥–</div>
                <div style="font-size: 14px;">å‰©ä½™: ${remainingChances} æ¬¡</div>
            `;
            startLotteryBtn.classList.remove('spinning');
            
            // æ›´æ–°å†å²æ˜¾ç¤º
            updateHistoryDisplay();
        }

        // æ·»åŠ åˆ°ä¸­å¥–åå•
        function addToWinners(name, prize, time) {
            winners.unshift({ name, prize, time });
            if (winners.length > 20) winners = winners.slice(0, 20);
            updateWinnerList();
        }

        // æ›´æ–°ä¸­å¥–åå•æ˜¾ç¤º
        function updateWinnerList() {
            winnerList.innerHTML = '';
            const allWinners = [...winners, ...winners]; // ç”¨äºæ— ç¼æ»šåŠ¨
            
            allWinners.forEach(winner => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <span>ğŸ‘¤ ${winner.name}</span>
                    <span style="color: #FFD700; margin: 0 10px;">${winner.prize}</span>
                    <span style="font-size: 12px; opacity: 0.8;">${winner.time}</span>
                `;
                winnerList.appendChild(li);
            });
        }

        // æ›´æ–°å†å²è®°å½•æ˜¾ç¤º
        function updateHistoryDisplay() {
            historyContent.innerHTML = '';
            
            if (history.length === 0) {
                historyContent.innerHTML = '<p style="text-align: center; padding: 40px;">æš‚æ— å†å²è®°å½•</p>';
                return;
            }
            
            history.forEach(record => {
                const recordDiv = document.createElement('div');
                recordDiv.style.cssText = 'display: flex; align-items: center; padding: 12px; margin-bottom: 10px; background: rgba(255,255,255,0.05); border-radius: 10px;';
                
                recordDiv.innerHTML = `
                    <img src="${record.image}" style="width: 50px; height: 50px; border-radius: 8px; margin-right: 15px;">
                    <div style="flex: 1;">
                        <div>${record.name}</div>
                        <div style="color: #FFD700;">${record.prize}</div>
                    </div>
                    <div style="font-size: 12px; opacity: 0.8;">${record.time}</div>
                `;
                
                historyContent.appendChild(recordDiv);
            });
        }

        // åˆ‡æ¢èƒŒæ™¯éŸ³ä¹
        function toggleBgMusic() {
            isBgMusicOn = !isBgMusicOn;
            bgMusicStatus.textContent = isBgMusicOn ? 'å¼€å¯' : 'å…³é—­';
            bgMusicBtn.style.background = isBgMusicOn ? 'rgba(255,215,0,0.2)' : '';
            
            if (isBgMusicOn) {
                bgMusic.play().catch(e => console.log("éŸ³ä¹æ’­æ”¾å¤±è´¥"));
            } else {
                bgMusic.pause();
            }
        }

        // åˆ‡æ¢éŸ³æ•ˆ
        function toggleSoundEffect() {
            isSoundEffectOn = !isSoundEffectOn;
            soundEffectStatus.textContent = isSoundEffectOn ? 'å¼€å¯' : 'å…³é—­';
            soundEffectBtn.style.background = isSoundEffectOn ? 'rgba(255,215,0,0.2)' : '';
        }

        // ç”Ÿæˆåˆå§‹æ•°æ®
        function generateInitialData() {
            const now = new Date();
            
            for (let i = 0; i < 10; i++) {
                const randomName = sampleNames[Math.floor(Math.random() * sampleNames.length)];
                const randomPrize = prizes[Math.floor(Math.random() * prizes.length)];
                const timeOffset = i * 30 * 60 * 1000;
                const recordTime = new Date(now.getTime() - timeOffset);
                
                const shortTime = `${recordTime.getHours().toString().padStart(2,'0')}:${recordTime.getMinutes().toString().padStart(2,'0')}`;
                const fullTime = `${recordTime.getFullYear()}-${(recordTime.getMonth()+1).toString().padStart(2,'0')}-${recordTime.getDate().toString().padStart(2,'0')} ${recordTime.getHours().toString().padStart(2,'0')}:${recordTime.getMinutes().toString().padStart(2,'0')}:${recordTime.getSeconds().toString().padStart(2,'0')}`;
                
                winners.push({
                    name: randomName,
                    prize: randomPrize.name,
                    time: shortTime
                });
                
                history.push({
                    name: randomName,
                    prize: randomPrize.name,
                    time: fullTime,
                    image: randomPrize.image
                });
            }
        }

        // åˆå§‹åŒ–
        function init() {
            initializePrizes();
            generateInitialData();
            updateWinnerList();
            updateHistoryDisplay();
            
            // å°è¯•è‡ªåŠ¨æ’­æ”¾èƒŒæ™¯éŸ³ä¹
            try {
                bgMusic.play();
            } catch (e) {
                bgMusicStatus.textContent = 'ç‚¹å‡»å¼€å¯';
                isBgMusicOn = false;
            }
        }

        // äº‹ä»¶ç›‘å¬
        startLotteryBtn.addEventListener('click', startLottery);
        bgMusicBtn.addEventListener('click', toggleBgMusic);
        soundEffectBtn.addEventListener('click', toggleSoundEffect);
        viewHistoryBtn.addEventListener('click', () => {
            historyModal.style.display = 'flex';
        });
        closeModal.addEventListener('click', () => {
            historyModal.style.display = 'none';
        });
        historyModal.addEventListener('click', (e) => {
            if (e.target === historyModal) {
                historyModal.style.display = 'none';
            }
        });

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.addEventListener('load', init);
        
        // çª—å£è°ƒæ•´å¤§å°æ—¶é‡æ–°å¸ƒå±€
        window.addEventListener('resize', initializePrizes);
    </script>
</body>
</html>
